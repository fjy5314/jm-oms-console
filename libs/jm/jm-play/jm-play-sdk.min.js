var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(module.exports=jm),function(){var e={},t={};e.registries=t,jm.root=e}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("./root.js")),function(){jm.ERR={OK:{err:0,msg:"Success"},FAIL:{err:1,msg:"Fail"},FA_SYS:{err:2,msg:"System Error"},FA_NETWORK:{err:3,msg:"Network Error"},FA_PARAMS:{err:4,msg:"Parameter Error "},FA_BADREQUEST:{err:400,msg:"Bad Request"},FA_NOAUTH:{err:401,msg:"Unauthorized"},FA_NOPERMISSION:{err:403,msg:"Forbidden"},FA_NOTFOUND:{err:404,msg:"Not Found"}}}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("./root.js")),function(){if("undefined"!=typeof exports&&"undefined"!=typeof module){var e=require("log4js");jm.getLogger=function(t){return e.getLogger(t)}}else jm.getLogger=function(e){return console.debug=console.debug||console.log,console};jm.logger=jm.getLogger()}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("./root.js")),function(){jm.aop={_Arguments:function(e){this.value=[].slice.call(e)},arguments:function(){return new this._Arguments(arguments)},inject:function(e,t,n){var r=this;return function(){var i,o=!1,s=[].slice.call(arguments);return"function"==typeof t&&(i=t.apply(this,s),i instanceof r._Arguments?s=i.value:(o=void 0!==i)&&s.push(i)),!o&&s.push(e.apply(this,s)),i="function"==typeof n?n.apply(this,s.concat(o)):void 0,void 0!==i?i:s.pop()}}}}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("./root.js")),function(){var e=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;jm.Class=function(){},jm.Class.extend=function(t){function n(){this._className&&Object.defineProperty(this,"className",{value:this._className,writable:!1}),this.ctor&&this.ctor.apply(this,arguments)}var r=this.prototype,i=Object.create(r);for(var o in t)"properties"!=o&&(i[o]="function"==typeof t[o]&&"function"==typeof r[o]&&e.test(t[o])?function(e,t){return function(){var n=this._super;this._super=r[e];var i=t.apply(this,arguments);return this._super=n,i}}(o,t[o]):t[o]);var s=t.properties;for(var u in s){var a=s[u];a.get&&"string"==typeof a.get&&(a.get=i[a.get]),a.set&&"string"==typeof a.set&&(a.set=i[a.set]),Object.defineProperty(i,u,a)}return n.prototype=i,n.prototype.constructor=n,n.extend=jm.Class.extend,n}}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("./root.js")),function(){jm.Object=jm.Class.extend({_className:"object",attr:function(e){for(var t in e)"className"!==t&&(this[t]=e[t])}}),jm.object=function(){return new jm.Object}}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("./root.js")),function(){var e=2e11;jm.Random=jm.Class.extend({_className:"random",properties:{seed:{get:"getSeed",set:"setSeed"}},ctor:function(t){t=t||{},this.g_seed=0,this.randomMax=t.randomMax||e},setSeed:function(e){this.g_seed=e},getSeed:function(){return this.g_seed},random:function(){return this.g_seed=(9301*this.g_seed+49297)%233280,this.g_seed/233280},randomInt:function(e,t){1===arguments.length&&(t=e,e=0);var n=e+this.random()*(t-e);return Math.round(n)},randomDouble:function(e,t){1===arguments.length&&(t=e,e=0);var n=e+this.random()*(t-e);return n},randomRange:function(e){return this.randomInt(0,this.randomMax)%e},randomOdds:function(e,t){return this.randomRange(e)<t?1:0}}),jm.random=function(e){return new jm.Random(e)}}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("./root.js")),function(){jm.EventEmitter=jm.Object.extend({_className:"eventEmitter",ctor:function(){this._events={},this.addListener=this.on},__createListener:function(e,t){return t=t,{fn:e,caller:t}},__equalsListener:function(e,t){return e.fn===t.fn&&e.caller===t.caller},on:function(e,t,n){var r=this.__createListener(t,n);return this._events[e]?Array.isArray(this._events[e])?this._events[e].push(r):this._events[e]=[this._events[e],r]:this._events[e]=r,this},once:function(e,t,n){function r(){i.removeListener(e,r),t.apply(o.caller,arguments)}var i=this,o=this.__createListener(t,n);return r.listener=o,this.on(e,r),this},removeListener:function(e,t,n){var r=this.__createListener(t,n);if(this._events&&this._events[e]){var i=this._events[e];if(Array.isArray(i)){for(var o=-1,s=0,u=i.length;s<u;s++){var a=i[s];if(this.__equalsListener(a,r)||a.listener&&this.__equalsListener(a.listener,r)){o=s;break}}if(o<0)return this;i.splice(o,1),i.length||delete this._events[e]}else(this.__equalsListener(i,r)||i.listener&&this.__equalsListener(i.listener,r))&&delete this._events[e]}return this},removeAllListeners:function(e){return void 0===e?(this._events={},this):(this._events&&this._events[e]&&(this._events[e]=null),this)},listeners:function(e){return this._events[e]||(this._events[e]=[]),Array.isArray(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]},emit:function(e){var t=this._events[e];if(!t)return!1;var n=Array.prototype.slice.call(arguments,1);if("object"!=typeof t||Array.isArray(t)){if(!Array.isArray(t))return!1;for(var r=t.slice(),i=0,o=r.length;i<o;i++){var s=r[i];if(s.fn.apply(s.caller||this,n)===!1)break}}else t.fn.apply(t.caller||this,n);return!0}}),jm.eventEmitter=function(){return new jm.EventEmitter};var e=jm.EventEmitter.prototype,t={_events:{},__createListener:e.__createListener,__equalsListener:e.__equalsListener,on:e.on,once:e.once,addListener:e.on,removeListener:e.removeListener,removeAllListeners:e.removeAllListeners,listeners:e.listeners,emit:e.emit},n=t;jm.enableEvent=function(e){if(void 0===e._events){for(var t in n)e[t]=n[t];e._events={}}},jm.disableEvent=function(e){for(var t in n)delete e[t]}}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("./root.js")),function(){jm.TagObject=jm.EventEmitter.extend({_className:"tagObject",ctor:function(){this._super(),this._tags=[],Object.defineProperty(this,"tags",{value:this._tags,writable:!1})},destroy:function(){this.emit("destroy",this),this.removeAllTags()},hasTag:function(e){var t=this._tags;return t.indexOf(e)!=-1},hasTagAny:function(e){for(var t in e){var n=e[t];if(this.hasTag(n))return!0}return!1},hasTagAll:function(e){for(var t in e){var n=e[t];if(!this.hasTag(n))return!1}return!0},addTag:function(e){var t=this._tags;return this.hasTag(e)?this:(t.push(e),this.emit("addTag",e),this)},addTags:function(e){for(var t in e){var n=e[t];this.addTag(n)}return this},removeTag:function(e){var t=this._tags,n=t.indexOf(e);return n>=0&&t.splice(n,1),this.emit("removeTag",e),this},removeTags:function(e){for(var t in e){var n=e[t];this.removeTag(n)}return this},removeAllTags:function(){var e=this._tags;for(i in e)this.emit("removeTag",e[i]);return this._tags=[],this.emit("removeAllTags"),this}}),jm.tagObject=function(){return new jm.TagObject};var e=jm.TagObject.prototype,t={_tags:[],hasTag:e.hasTag,hasTagAny:e.hasTagAny,hasTagAll:e.hasTagAll,addTag:e.addTag,addTags:e.addTags,removeTag:e.removeTag,removeTags:e.removeTags,removeAllTags:e.removeAllTags};jm.enableTag=function(e){if(void 0==e._tags){for(key in t)e[key]=t[key];e._tags=[],Object.defineProperty(e,"tags",{value:e._tags,writable:!1}),jm.enableEvent(e)}},jm.disableTag=function(e){for(key in t)delete e[key];jm.disableEvent(e)}}();var jm=jm||{};"undefined"!=typeof module&&module.exports&&(jm=require("jm-core")),function(){var e=jm,t=jm.ERR,n=jm.getLogger("jm:ajax");"undefined"!=typeof module&&module.exports?e.ajax=require("najax"):!function(e){var n={extend:function(e){return n.each(Array.prototype.slice.call(arguments,1),function(t){for(var n in t)void 0!==t[n]&&(e[n]=t[n])}),e},each:function(e,t,n){if(null!==e)if(i&&e.forEach===i)e.forEach(t,n);else if(e.length===+e.length){for(var r=0,o=e.length;r<o;r++)if(r in e&&t.call(n,e[r],r,e)===breaker)return}else for(var s in e)if(hasOwnProperty.call(e,s)&&t.call(n,e[s],s,e)===breaker)return}},r={};_xhrf=null;var i=Array.prototype.forEach,o=(n.each,n.extend);r.xhr=function(){return new XMLHttpRequest},r._xhrResp=function(e){switch(e.getResponseHeader("Content-Type").split(";")[0]){case"text/xml":return e.responseXML;case"text/json":case"application/json":case"text/javascript":case"application/javascript":case"application/x-javascript":try{return JSON.parse(e.responseText)}catch(e){return t.FAIL}default:return e.responseText}},r._formData=function(e){var t=[],n=/%20/g;for(var r in e)e[r]&&t.push(encodeURIComponent(r).replace(n,"+")+"="+encodeURIComponent(e[r].toString()).replace(n,"+"));return t.join("&")},r.ajax=function(e){var t=r.xhr(),n=null,i=0;if("function"==typeof t.open){e=o({userAgent:"XMLHttpRequest",lang:"en",type:"GET",data:null,contentType:"application/x-www-form-urlencoded"},e),e.timeout&&(n=setTimeout(function(){e.error.timeout=!0,t.abort(),e.timeoutFn&&e.timeoutFn(e.url)},e.timeout)),t.onreadystatechange=function(){4==t.readyState?(null!=n&&(clearTimeout(n),n=null),t.status>=200&&t.status<300||304===t.status?e.success&&e.success(r._xhrResp(t)):e.error&&e.error(t,t.status,t.statusText),e.complete&&e.complete(r._xhrResp(t),t,t.statusText)):e.progress&&e.progress(++i)};var s=e.url,u=null;e.type=(e.type||"GET").toUpperCase();var a="POST"==e.type||"PUT"==e.type;if(!a&&e.data&&(s+="?"+r._formData(e.data)),t.open(e.type,s),a){var f=e.contentType.indexOf("json")>=0;u=f?JSON.stringify(e.data):r._formData(e.data),t.setRequestHeader("Content-Type",f?"application/json":"application/x-www-form-urlencoded")}u?t.send(u):t.send()}},e.ajax=r.ajax}(e),jm.enableAjax=function(r,i){i=i||{};var o=i.ignoreDocErr||!1,s=i.types||["get","post","put","delete"],u=i.timeout||0;Array.isArray(s)||(s=[s]),s.forEach(function(i){r[i]=function(r,s){var a={};for(var f in r)a[f]=r[f];a.type=i,a.contentType=a.contentType||"application/json",a.dataType=a.dataType||"json",a.timeout=a.timeout||u,a.success=a.success||function(e){if(s){var t=null;e&&e.err&&!o&&(t=new Error(e.msg||e.err)),s(t,e)}},a.error=a.error||function(e,o,u){var f=i.toUpperCase()+" "+r.url;a.error.timeout&&(u=new Error("timeout")),u=u||new Error(f),n.debug("failed. "+f),s&&s(u,t.FA_NETWORK)},e.ajax(a)}})}}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("jm-core")),function(){jm.sdk=jm.sdk||{};var e=jm.sdk;jm.enableEvent(e),e.getLogger=jm.getLogger,e.logger=e.getLogger(),e.init=function(t){t=t||{},e.emit("init",t)}}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("jm-core")),function(){var e=jm.sdk||{};e.consts={ERR:jm.ERR}}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("jm-core")),function(){var e=jm.sdk||{};e.utils={formatJSON:function(e){return JSON.stringify(e,null,2)}}}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("jm-ajax")),function(){var e=jm.sdk||{};e.$={};var t=e.$;e.consts.ERR;t.ajax=jm.ajax,t.get||["get","post","put","delete","patch"].forEach(function(e){t[e]=function(n){n.type=e,t.ajax(n)}}),e.enableAjax=jm.enableAjax}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("jm-core")),function(){var e=jm.sdk||{},t=!1,n={};"undefined"!=typeof exports&&"undefined"!=typeof module&&(t=!0),e.storage={setItem:function(e,r){t?n[e]=r:localStorage.setItem(e,r)},getItem:function(e){return t?n[e]:localStorage.getItem(e)},removeItem:function(e){t?delete n[e]:localStorage.removeItem(e)}}}();var jm=jm||{};"undefined"!=typeof module&&module.exports&&(jm=require("jm-core")),function(){jm.ms=function(e){var t=jm.ms.router(e);return t}}();var jm=jm||{};"undefined"!=typeof module&&module.exports&&(jm=require("jm-core")),function(){jm.ms=jm.ms||{};var e=jm.ms,t=900;jm.ERR.ms={FA_INVALIDTYPE:{err:t++,msg:"无效的类型"}},e.consts={}}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("jm-core")),function(){function e(e){for(var t,n=[],r=0,o=0,s="";null!=(t=l.exec(e));){var u=t[0],a=t[1],f=t.index;if(s+=e.slice(o,f),o=f+u.length,a)s+=a[1];else{s&&(n.push(s),s="");var c=t[2],m=t[3],d=t[4],p=t[5],h=t[6],v=t[7],g="+"===h||"*"===h,j="?"===h||"*"===h,y=c||"/",k=d||p||(v?".*":"[^"+y+"]+?");n.push({name:m||r++,prefix:c||"",delimiter:y,optional:j,repeat:g,pattern:i(k)})}}return o<e.length&&(s+=e.substr(o)),s&&n.push(s),n}function t(t){return n(e(t))}function n(e){for(var t=new Array(e.length),n=0;n<e.length;n++)"object"==typeof e[n]&&(t[n]=new RegExp("^"+e[n].pattern+"$"));return function(n){for(var r="",i=n||{},o=0;o<e.length;o++){var s=e[o];if("string"!=typeof s){var u,a=i[s.name];if(null==a){if(s.optional)continue;throw new TypeError('Expected "'+s.name+'" to be defined')}if(d(a)){if(!s.repeat)throw new TypeError('Expected "'+s.name+'" to not repeat, but received "'+a+'"');if(0===a.length){if(s.optional)continue;throw new TypeError('Expected "'+s.name+'" to not be empty')}for(var f=0;f<a.length;f++){if(u=encodeURIComponent(a[f]),!t[o].test(u))throw new TypeError('Expected all "'+s.name+'" to match "'+s.pattern+'", but received "'+u+'"');r+=(0===f?s.prefix:s.delimiter)+u}}else{if(u=encodeURIComponent(a),!t[o].test(u))throw new TypeError('Expected "'+s.name+'" to match "'+s.pattern+'", but received "'+u+'"');r+=s.prefix+u}}else r+=s}return r}}function r(e){return e.replace(/([.+*?=^!:${}()[\]|\/])/g,"\\$1")}function i(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function o(e,t){return e.keys=t,e}function s(e){return e.sensitive?"":"i"}function u(e,t){var n=e.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)t.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return o(e,t)}function a(e,t,n){for(var r=[],i=0;i<e.length;i++)r.push(m(e[i],t,n).source);var u=new RegExp("(?:"+r.join("|")+")",s(n));return o(u,t)}function f(t,n,r){for(var i=e(t),s=c(i,r),u=0;u<i.length;u++)"string"!=typeof i[u]&&n.push(i[u]);return o(s,n)}function c(e,t){t=t||{};for(var n=t.strict,i=t.end!==!1,o="",u=e[e.length-1],a="string"==typeof u&&/\/$/.test(u),f=0;f<e.length;f++){var c=e[f];if("string"==typeof c)o+=r(c);else{var m=r(c.prefix),d=c.pattern;c.repeat&&(d+="(?:"+m+d+")*"),d=c.optional?m?"(?:"+m+"("+d+"))?":"("+d+")?":m+"("+d+")",o+=d}}return n||(o=(a?o.slice(0,-2):o)+"(?:\\/(?=$))?"),o+=i?"$":n&&a?"":"(?=\\/|$)",new RegExp("^"+o,s(t))}function m(e,t,n){return t=t||[],d(t)?n||(n={}):(n=t,t=[]),e instanceof RegExp?u(e,t,n):d(e)?a(e,t,n):f(e,t,n)}jm.ms.pathToRegexp=m,m.parse=e,m.compile=t,m.tokensToFunction=n,m.tokensToRegExp=c;var d=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)},l=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))"].join("|"),"g")}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("jm-core")),function(){var e=jm.ms||{},t=(jm.ERR,e.pathToRegexp),n=jm.TagObject.extend({_className:"route",ctor:function(e){this._super(),e&&this.attr(e),this._fns=[],Object.defineProperty(this,"fns",{value:this._fns,writable:!1}),this.uri=this.uri||"/",this.keys=[],this.regexp=t(this.uri,this.keys,e),"/"===this.uri&&e.end===!1&&(this.regexp.fast_slash=!0),void 0==this.type&&(this.allType=!0);var n=e.fn;Array.isArray(n)||(n=[n]);for(var r=0;r<n.length;r++){var i=n[r];if("function"!=typeof i){var o=toString.call(i),s="requires callback functions but got a "+o;throw new TypeError(s)}this._fns.push(i)}},handle:function(e,t,n){function r(s,u){if(s)return"route"===s?n():t(s,u);var a=o[i++];if(!a)return n(s);try{a(e,t,r)}catch(e){r(e)}}var i=0,o=this.fns;return 0===o.length?n():void r()},match:function(e,t){if(t&&(t=t.toLowerCase()),t!=this.type&&!this.allType)return!1;if(null==e)return this.params=void 0,this.uri=void 0,!1;if(this.regexp.fast_slash)return this.params={},this.uri="",!0;var n=this.regexp.exec(e);if(!n)return this.params=void 0,this.uri=void 0,!1;this.params={},this.uri=n[0];for(var r=this.keys,i=this.params,o=1;o<n.length;o++){var s=r[o-1],u=s.name;i[u]=n[o]}return!0}});e.Route=n,e.route=function(e){return new n(e)}}();var jm=jm||{};"undefined"!=typeof module&&module.exports&&(jm=require("jm-core")),function(){var e=jm.ms||{},t=jm.ERR,n=function(e,t){},r=Array.prototype.slice,i=jm.TagObject.extend({_className:"router",ctor:function(t){var n=this;this._super(),t&&this.attr(t),this._routes=[],Object.defineProperty(this,"routes",{value:this._routes,writable:!1}),e.utils.enableType(n,["get","post","put","delete"])},_add:function(n,r){n=n||{};var i=null,o=null;if(n.uri&&n.fn){this.emit("add",n);var s={};for(var u in n)s[u]=n[u];void 0===s.mergeParams&&(s.mergeParams=this.mergeParams),void 0===s.sensitive&&(s.sensitive=this.sensitive),void 0===s.strict&&(s.strict=this.strict);var a=e.route(s);this._routes.push(a)}else if(o=t.FA_PARAMS,i=new Error(o.msg),!r)throw i;return r&&r(i,o),this},add:function(e,t){return"string"==typeof e&&(e={uri:e},"string"==typeof t?(e.type=t,Array.isArray(arguments[2])?e.fn=arguments[2]:e.fn=r.call(arguments,2)):Array.isArray(t)?e.fn=t:e.fn=r.call(arguments,1),t=null),this._add(e,t)},_use:function(e,n){e=e||{};var r=null,o=null;if(e&&e instanceof i&&(e={fn:e}),e.fn){if(this.emit("use",e),e.strict=!1,e.end=!1,e.uri=e.uri||"/",e.fn instanceof i){var s=e.fn;e.router=s,e.fn=function(e,t,n){s.handle(e,t,n)}}else if("object"==typeof e.fn){var s=e.fn;s.request?(e.router=s,e.fn=function(e,t,n){s.request(e,function(e,r){t(e,r),n()})}):s.handle&&(e.router=s,e.fn=function(e,t,n){s.handle(e,t,n)})}return this._add(e,n)}if(o=t.FA_PARAMS,r=new Error(o.msg,o.err),!n)throw r;return n&&n(r,o),this},use:function(e,t){return"string"==typeof e?(e={uri:e},"object"==typeof t?e.fn=t:Array.isArray(t)?e.fn=t:e.fn=r.call(arguments,1),t=null):"function"==typeof e?(e={fn:r.call(arguments,0)},t=null):Array.isArray(e)&&(e={fn:e},t=null),this._use(e,t)},request:function(t,r){var i=e.utils.preRequest.apply(this,arguments);return this.handle(i.opts,i.cb||n)},handle:function(e,t,n){function r(){if(t.done)return l();if(e.baseUri=d,e.uri=p,f>=c.length)return l();for(var n,i=!1;!i&&f<c.length;)if(n=c[f++])try{i=n.match(e.uri,e.type)}catch(e){return l(e)}if(!i)return l();e.params={};for(var o in m)e.params[o]=m[o];for(var o in n.params)e.params[o]=n.params[o];n.router&&(e.baseUri=d+n.uri,e.uri=e.uri.replace(n.uri,"")),n.handle(e,t,r)}function i(e,t){for(var n=new Array(arguments.length-2),r=new Array(arguments.length-2),i=0;i<n.length;i++)n[i]=arguments[i+2],r[i]=t[n[i]];return function(i){for(var o=0;o<n.length;o++)t[n[o]]=r[o];return e&&e.apply(this,arguments),a}}if(!n){var o=e,s=t;e={};for(var u in o)e[u]=o[u];t=function(e,n){t.done||(t.done=!0,s(e,n))},n=function(){t(new Error(jm.ERR.FA_NOTFOUND.msg),jm.ERR.FA_NOTFOUND)}}var a=this,f=0,c=a.routes,m=e.params,d=e.baseUri||"",l=i(n,e,"baseUri","params");e.originalUri=e.originalUri||e.uri;var p=e.uri;return r(),a}});e.Router=i,e.router=function(e){return new i(e)}}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("jm-core")),function(){var e=Array.prototype.slice,t=jm.ms||{};t.utils={formatJSON:function(e){return JSON.stringify(e,null,2)},getUriProtocol:function(e){return e?e.substring(0,e.indexOf(":")):null},getUriPath:function(e){var t=e.indexOf("//");if(t==-1)return"";var t=e.indexOf("/",t+2);return t==-1?"":(e=e.substr(t),t=e.indexOf("#"),t==-1&&(t=e.indexOf("?")),t!=-1&&(e=e.substr(0,t)),e)},enableType:function(e,t){Array.isArray(t)||(t=[t]),t.forEach(function(t){e[t]=function(n,r){if("string"==typeof n){var i=Array.prototype.slice.call(arguments,0);return i.splice(1,0,t),e.request.apply(e,i)}return n.type=t,e.request(n,r)}})},preRequest:function(t,n){if("string"==typeof t){var r=arguments.length,i=e.call(arguments,0);n=null,"function"==typeof i[r-1]&&(n=i[r-1],r--),t={uri:t},"number"==typeof i[r-1]&&(t.timeout=i[r-1],r--);var o=1;o<r&&i[o]&&(t.type=i[o]),o++,o<r&&i[o]&&(t.data=i[o]),o++,o<r&&i[o]&&(t.params=i[o])}return{opts:t,cb:n}}}}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("jm-core")),function(){var e=jm.ms||{},t=jm.ERR,n=jm.root.registries;n.ms={client:{types:{}}};var r=n.ms.client.types;e.registClientType=function(e,n){e=e||{};var i=null,o=null;if(e.type&&e.fn){var s=e.type.toLowerCase();r[s]={type:s,port:e.port,fn:e.fn}}else i=new Error("invalid params"),o=t.FA_PARAMS;return n&&n(i,o),this},e.unregistClientType=function(e,n){e=e||{};var i=null,o=null;if(e.type){var s=e.type.toLowerCase();r[s]&&delete r[s]}else i=new Error("invalid params"),o=t.FA_PARAMS;return n&&n(i,o),this},e.client=function(n,i){n=n||{};var o=null,s=null,u=null;n.uri&&(u=e.utils.getUriProtocol(n.uri)),u=n.type||u||"http",u=u.toLowerCase();var a=r[u];return a?(a.fn.call(this,n,function(t,n){e.utils.enableType(n,["get","post","put","delete"]),i(t,n)}),this):(o=new Error("invalid type"),s=t.ms.FA_INVALIDTYPE,i&&i(o,s),this)}}();var jm=jm||{},WebSocket=WebSocket||null;!function(){"use strict";var e=3100,t=null;"undefined"!=typeof module&&module.exports?(jm=require("jm-ms-core"),WebSocket=require("ws"),t=function(e,t){var n=new WebSocket(e);return n.on("message",function(e,n){t(e)}),n}):t=function(e,t){var n=new WebSocket(e);return n.onmessage=function(e){t(e.data)},n};var n=jm.getLogger("jm-ms-ws:client"),r=function(r,o){r=r||{};var s=null,u=null,a=!1,f=0,c={},m={request:function(e,t){var n=i.utils.preRequest.apply(this,arguments);return e=n.opts,t=n.cb,a?(e.uri=h+(e.uri||""),t&&(f++,c[f]=t,e.id=f),void u.send(JSON.stringify(e))):t(new Error(jm.ERR.FA_NETWORK.msg),jm.ERR.FA_NETWORK)}};jm.enableEvent(m);var d=function(e){n.debug("received: %s",e),m.emit("message",e);var t=null;try{t=JSON.parse(e)}catch(e){return}if(t.id&&c[t.id]){var r=null,i=t.data;i.err&&(r=new Error(i.msg)),c[t.id](r,i),delete c[t.id]}},l=r.uri||"ws://127.0.0.1:"+e,p=jm.ms.utils.getUriPath(l),h=r.prefix||"";h=p+h;var v=!1,g=null,j=0,y=r.reconnectionDelay||5e3,k=10,A=r.maxReconnectAttempts||k,_=function(){n.debug("connect to "+l);var e=m,i=function(t){n.debug("connected to "+l),a=!0,v&&e.emit("reconnect"),e.emit("open"),e.onopen&&(n.warn("Deprecated: onopen, please use on('open' function(err,doc){})."),e.onopen(t))},o=function(t){a=!1,e.emit("close"),n.error("socket close: ",t),r.reconnect&&j<A&&(v=!0,j++,g=setTimeout(function(){_()},y),y*=2)},s=function(e){m.emit("error")};u=t(l,d),u.onopen=i,u.onerror=s,u.onclose=o};return _(),o&&o(s,m),this};n=jm.getLogger("jm-ms-ws:client");var i=jm.ms;i.registClientType({type:"ws",fn:r})}();var jm=jm||{};"undefined"!=typeof module&&module.exports&&(jm=require("jm-ms-core"),require("jm-ajax")),function(){"use strict";var e=jm.ms,t=3e3,n={};jm.enableAjax(n);var r=function(r,i){r=r||{};var o=null,s=null,u=r.uri||"http://127.0.0.1:"+t,a=r.timeout||0;return s={request:function(t,r){var i=e.utils.preRequest.apply(this,arguments);t=i.opts,r=i.cb;var o=t.type||"get";n[o]({url:u+t.uri,timeout:t.timeout||a,data:t.data},r)}},jm.enableEvent(s),i&&i(o,s),this};e.registClientType({type:"http",fn:r})}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("jm-sdk-core"),require("jm-ms")),function(){var e=jm.sdk,t=jm.ms;e.on("init",function(t){var n="config";t[n]=t[n]||{},t[n].uri=t[n].uri||t.uri,t[n].timeout=t[n].timeout||t.timeout,e[n].init(t[n])}),e.config={init:function(e){var n=this;e=e||{};var r=e.uri,i=e.prefix||"/config";this.uri=r+i,t.client({uri:this.uri,timeout:e.timeout||0},function(e,t){n.client=t}),jm.enableEvent(this)},_getlisturi:function(e){var t=e.root||"";return"/"+t},_geturi:function(e){var t=e.key||"";return this._getlisturi(e)+"/"+t},getConfig:function(e,t){t=t||function(){},e=e||{};var n=this._geturi(e);this.client.get({uri:n},t)},setConfig:function(e,t){t=t||function(){},e=e||{};var n=this._geturi(e);this.client.post({uri:n,data:e},t)},delConfig:function(e,t){t=t||function(){},e=e||{};var n=this._geturi(e);this.client.delete({uri:n},t)},delRoot:function(e,t){t=t||function(){},e=e||{};var n=this._getlisturi(e);this.client.delete({uri:n},t)},listConfig:function(e,t){t=t||function(){},e=e||{};var n=this._getlisturi(e);e.all&&(n+="?all=1"),this.client.get({uri:n},t)},setConfigs:function(e,t){t=t||function(){},e=e||{};var n=this._geturi(e);this.client.post({uri:n,data:e},t)}}}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("jm-sdk-core")),function(){var e=jm.sdk,t=(e.$,e.storage),n=e.consts.ERR;e.on("init",function(t){var n="sso";t[n]=t[n]||{},t[n].uri=t[n].uri||t.uri,t[n].timeout=t[n].timeout||t.timeout,e[n].init(t[n])}),e.sso={init:function(t){t=t||{};var n=t.uri,r=t.prefix||"/sso";this.uri=n+r,jm.enableEvent(this),e.enableAjax(this,{timeout:t.timeout||0})},signup:function(e,t){var n=this;t=t||function(){},this.post({url:this.uri+"/signup",data:e},function(r,i){!r&&i&&i.id||(r=new Error("注册失败")),r?t(r,i):n.signon(e,t),n.emit("signup",r,i)})},signon:function(e,n){var r=this;n=n||function(){},this.post({url:this.uri+"/signon",data:e},function(i,o){!i&&o&&o.id?(t.setItem("token",o.token),t.setItem("id",o.id)):(t.removeItem("token"),t.removeItem("id"),i=new Error("登录失败")),i?n(i,o):r.getUser(e,n),r.emit("signon",i,o)})},signon_guest:function(e,n){var r=this;this.post({url:this.uri+"/signon_guest",data:e},function(e,i){!e&&i&&i.id?(t.setItem("token",i.token),t.setItem("id",i.id)):(t.removeItem("token"),t.removeItem("id"),e=new Error("登录失败")),n(e,i),r.emit("signon",e,i)})},getAvatarUri:function(e){var t=e||self.user;return t?t.headimgurl||"/upload/sso/"+t.id+"/images/avatar.jpg":"/images/avatar.png"},getUser:function(e,r){var i=this;r=r||function(){},e=e||{};var o=e.token||t.getItem("token");return o?void this.get({url:this.uri+"/user",data:{token:o}},function(e,n){if(!e&&n&&n.id){i.user={token:o};for(var s in n)i.user[s]=n[s];i.user.nick=i.user.nick||"楼主很懒连名字都不起一下",n=i.user}else t.removeItem("token"),t.removeItem("id"),e=new Error("获取用户信息失败");r(e,n),i.emit("getUser",e,n)}):r(new Error("获取用户信息失败"),n.FA_NOAUTH)},signout:function(e,n){var r=this;n=n||function(){},e=e||{};var i=e.token||t.getItem("token");i&&this.get({url:this.uri+"/signout",data:{token:i}},function(e,t){}),t.removeItem("token"),t.removeItem("id"),r.user={},n(),r.emit("signout")},updatePasswd:function(e,r){r=r||function(){},e=e||{};var i=e.token||t.getItem("token");return i?(e.token=i,void this.post({url:this.uri+"/user/passwd",data:e},r)):r(new Error("修改密码失败"),n.FA_NOAUTH)},updateUser:function(e,r){r=r||function(){},e=e||{};var i=e.token||t.getItem("token");return i?(e.token=i,void this.post({url:this.uri+"/user",data:e},r)):r(new Error("更新用户信息失败"),n.FA_NOAUTH)},getVerifyCode:function(e,t){t=t||function(){},this.get({url:this.uri+"/verifyCode",data:e},t)},checkVerifyCode:function(e,t){t=t||function(){},this.get({url:this.uri+"/verifyCode/check",data:e},t)}}}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("jm-sdk-core")),function(){var e=jm.sdk,t=e.storage,n=e.consts.ERR;e.on("init",function(t){var n="acl";t[n]=t[n]||{},t[n].uri=t[n].uri||t.uri,t[n].timeout=t[n].timeout||t.timeout,e[n].init(t[n])}),e.acl={init:function(t){t=t||{};var n=t.uri,r=t.prefix||"/acl";this.uri=n+r,jm.enableEvent(this),e.enableAjax(this,{timeout:t.timeout||0})},filter:function(e,n){e=e||{},n=n||function(){},e.token=e.token||t.getItem("token"),this.get({url:this.uri+"/filter",data:e},n)},initResources:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.get({url:this.uri+"/initresources",data:e},r):r(new Error("初始资源失败"),n.FA_NOAUTH)},initPermissions:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.get({url:this.uri+"/initpermissions",data:e},r):r(new Error("初始权限失败"),n.FA_NOAUTH)},userRoles:function(e,n){e=e||{},n=n||function(){},e.token=e.token||t.getItem("token"),this.get({url:this.uri+"/user/roles",data:e},n)},userPermissions:function(e,n){e=e||{},n=n||function(){},e.token=e.token||t.getItem("token"),this.get({url:this.uri+"/user/permissions",data:e},n)},addUserRoles:function(e,r){if(e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),!e.token||!e.id||!e.role)return r(new Error("添加用户角色失败"),n.FA_NOAUTH);var i=e.id;this.post({url:this.uri+"/roles/"+i+"/roles",data:e},r)},removeUserRoles:function(e,r){if(e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),!e.token||!e.id||!e.role)return r(new Error("删除用户角色失败"),n.FA_NOAUTH);var i=e.id;this.delete({url:this.uri+"/roles/"+i+"/roles",data:e},r)}}}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("jm-sdk-core")),function(){var e=jm.sdk,t=e.storage,n=e.consts.ERR;e.on("init",function(t){var n="agent";t[n]=t[n]||{},t[n].uri=t[n].uri||t.uri,t[n].timeout=t[n].timeout||t.timeout,e[n].init(t[n])}),e.agent={init:function(t){t=t||{};var n=t.uri,r=t.prefix||"/agent";this.uri=n+r,jm.enableEvent(this),e.enableAjax(this,{timeout:t.timeout||0})},userAgent:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.get({url:this.uri+"/userAgent",data:e},r):r(new Error("获取用户渠道失败"),n.FA_NOAUTH)}}}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("jm-sdk-core")),function(){var e=jm.sdk,t=e.storage,n=e.consts.ERR;e.on("init",function(t){var n="bank";t[n]=t[n]||{},t[n].uri=t[n].uri||t.uri,t[n].timeout=t[n].timeout||t.timeout,e[n].init(t[n])}),e.bank={init:function(t){t=t||{};var n=t.uri,r=t.prefix||"/bank";this.uri=n+r,jm.enableEvent(this),e.enableAjax(this,{timeout:t.timeout||0})},query:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.get({url:this.uri+"/query",data:e},r):r(new Error("获取账户信息失败"),n.FA_NOAUTH)},accounts:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.get({url:this.uri+"/accounts",data:e},r):r(new Error("获取账户信息失败"),n.FA_NOAUTH)},status:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.post({url:this.uri+"/account/status",data:e},r):r(new Error("更新状态失败"),n.FA_NOAUTH)},preauth:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.post({url:this.uri+"/preauth",data:e},r):r(new Error("预授权失败"),n.FA_NOAUTH)},preauthCancel:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.delete({url:this.uri+"/preauth",data:e},r):r(new Error("取消预授权失败"),n.FA_NOAUTH)},preauthList:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.get({url:this.uri+"/preauth",data:e},r):r(new Error("获取预授权列表失败"),n.FA_NOAUTH)},transfer:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.post({url:this.uri+"/transfer",data:e},r):r(new Error("转账失败"),n.FA_NOAUTH)},exchange:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.post({url:this.uri+"/exchange",data:e},r):r(new Error("兑换失败"),n.FA_NOAUTH)},updatePasswd:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.post({url:this.uri+"/updatePasswd",data:e},r):r(new Error("更新密码失败"),n.FA_NOAUTH)},resetPasswd:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.post({url:this.uri+"/resetPasswd",data:e},r):r(new Error("重置密码失败"),n.FA_NOAUTH)},history:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.get({url:this.uri+"/history",data:e},r):r(new Error("获取交易历史失败"),n.FA_NOAUTH)},isVaildPasswd:function(e,n){e=e||{},n=n||function(){},e.token=e.token||t.getItem("token"),this.get({url:this.uri+"/isVaildPasswd",data:e},n)},isCP:function(e,n){e=e||{},n=n||function(){},e.token=e.token||t.getItem("token"),this.get({url:this.uri+"/isCP",data:e},n)},exchangeRate:function(e,t){e=e||{},t=t||function(){},this.get({url:this.uri+"/exchangeRate",data:e},t)}}}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(require("jm-config/dist/js/jm-sdk-config"),jm=require("jm-sdk-core"));var jm=jm||{};
"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("jm-sdk-core")),function(){var e=jm.sdk,t=e.storage,n=e.consts.ERR;e.on("init",function(t){var n="dak";t[n]=t[n]||{},t[n].uri=t[n].uri||t.uri,t[n].timeout=t[n].timeout||t.timeout,e[n].init(t[n])}),e.dak={init:function(t){t=t||{};var n=t.uri,r=t.prefix||"/dak";this.uri=n+r,jm.enableEvent(this),e.enableAjax(this,{timeout:t.timeout||0})},listDaks:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.get({url:this.uri+"/daks",data:e},r):r(new Error("获取邮件列表失败"),n.FA_NOAUTH)},getDak:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?e.id?void this.get({url:this.uri+"/daks/"+e.id,data:e},r):r(new Error("获取邮件失败"),n.FAIL):r(new Error("获取邮件失败"),n.FA_NOAUTH)},send:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.post({url:this.uri+"/send",data:e},r):r(new Error("发送邮件失败"),n.FA_NOAUTH)},take:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.post({url:this.uri+"/take",data:e},r):r(new Error("领取附件失败"),n.FA_NOAUTH)},delete:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.delete({url:this.uri+"/delete",data:e},r):r(new Error("删除邮件失败"),n.FA_NOAUTH)}}}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("jm-sdk-core")),function(){var e=jm.sdk,t=e.storage,n=e.consts.ERR;e.on("init",function(t){var n="depot";t[n]=t[n]||{},t[n].uri=t[n].uri||t.uri,t[n].timeout=t[n].timeout||t.timeout,e[n].init(t[n])}),e.depot={init:function(t){t=t||{};var n=t.uri,r=t.prefix||"/depot";this.uri=n+r,jm.enableEvent(this),e.enableAjax(this,{timeout:t.timeout||0})},listProps:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.get({url:this.uri+"/props",data:e},r):r(new Error("获取用户道具信息失败"),n.FA_NOAUTH)},getProp:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.get({url:this.uri+"/prop",data:e},r):r(new Error("获取指定道具信息失败"),n.FA_NOAUTH)},giveProp:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.post({url:this.uri+"/props",data:e},r):r(new Error("给予某用户道具失败"),n.FA_NOAUTH)},useProp:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.post({url:this.uri+"/useProp",data:e},r):r(new Error("使用道具失败"),n.FA_NOAUTH)},delProp:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.delete({url:this.uri+"/prop",data:e},r):r(new Error("销毁道具失败"),n.FA_NOAUTH)}}}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("jm-sdk-core")),function(){var e=jm.sdk,t=e.storage,n=e.consts.ERR;e.on("init",function(t){var n="pay";t[n]=t[n]||{},t[n].uri=t[n].uri||t.uri,t[n].timeout=t[n].timeout||t.timeout,e[n].init(t[n])}),e.pay={init:function(t){t=t||{};var n=t.uri,r=t.prefix||"/pay";this.uri=n+r,jm.enableEvent(this),e.enableAjax(this,{timeout:t.timeout||0})},prepay:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.post({url:this.uri+"/pays",data:e},r):r(new Error("预请求支付失败"),n.FA_NOAUTH)},refund:function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.post({url:this.uri+"/refund",data:e},r):r(new Error("请求退款失败"),n.FA_NOAUTH)}},e.enableAjax(e.pay)}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(require("jm-sso/dist/js/jm-sdk-sso"),jm=require("jm-sdk-core")),function(){var e=jm.sdk,t=e.storage,n=e.consts.ERR,r=e.sso;r.verifyCode=function(e,t){t=t||function(){},this.get({url:this.uri+"/verifycode",data:e},t)},r.resetPasswd=function(e,t){t=t||function(){};this.post({url:this.uri+"/resetPasswd",data:e},t)},r.bindMobile=function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.post({url:this.uri+"/bindMobile",data:e},r):r(new Error("绑定手机号失败"),n.FA_NOAUTH)},r.getUsers=function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.get({url:this.uri+"/users",data:e},r):r(new Error("获取用户列表失败"),n.FA_NOAUTH)},r.findUser=function(e,n){e=e||{},n=n||function(){},e.token=e.token||t.getItem("token"),this.get({url:this.uri+"/findUser",data:e},n)},r.isSignon=function(e,n){e=e||{},n=n||function(){},e.token=e.token||t.getItem("token"),this.get({url:this.uri+"/isSignon",data:e},n)},r.isCheckCode=function(e,n){e=e||{},n=n||function(){},e.token=e.token||t.getItem("token"),this.get({url:this.uri+"/isCheckCode",data:e},n)},r.removeUsers=function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.delete({url:this.uri+"/users",data:e},r):r(new Error("删除用户失败"),n.FA_NOAUTH)},r.createUser=function(e,r){return e=e||{},r=r||function(){},e.token=e.token||t.getItem("token"),e.token?void this.post({url:this.uri+"/users",data:e},r):r(new Error("创建用户失败"),n.FA_NOAUTH)},r.updateUser=function(e,r){r=r||function(){},e=e||{};var i=e.token||t.getItem("token");if(!i)return r(new Error("更新用户信息失败"),n.FA_NOAUTH);e.token=i;var o="/user";e.userId&&(o="/users/"+e.userId),this.post({url:this.uri+o,data:e},r)},r.ranking=function(e,n){e=e||{},n=n||function(){},e.token=e.token||t.getItem("token"),this.get({url:this.uri+"/ranking",data:e},n)}}();